!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react"),require("prop-types"),require("resize-observer-polyfill")):"function"==typeof define&&define.amd?define(["react","prop-types","resize-observer-polyfill"],t):e.Gallery=t(e.React,e.PropTypes,e.ResizeObserver)}(this,function(e,t,n){"use strict";function r(e,t){return t||(t=0),Number(Math.round(e+"e"+t)+"e-"+t)}function o(e){return r(e.width/e.height,2)}function i(e){var t=e.photos,n=e.columns,i=e.width,u=e.margin;if(!i)return[];var a=t.reduce(function(e,t,r){var o=Math.floor(r/n);return e[o]=e[o]?[].concat(h(e[o]),[t]):[t],e},[]),c=[];return a.map(function(e,s){var f=e.reduce(function(e,t){return e+o(t)},0),p=i-e.length*(2*u);s!==a.length-1&&c.push(f);var h=e.length===n?p/f:t.length<n?p/f*(e.length/n):p/(c.reduce(function(e,t){return e+t},0)/(a.length-1));return e.map(function(e){return l({},e,{height:r(h,1),width:r(h*o(e),1)})})}).reduce(function(e,t){return[].concat(h(e),h(t))},[])}function u(e){for(var t=e.photos,n=e.columns,o=e.width,i=e.margin,u=(o-2*i*n)/n,a=t.map(function(e){var t=e.height/e.width*u;return l({},e,{width:r(u,1),height:r(t,1)})}),c=[],s=[],f=0;f<n;f++)c[f]=r(f*(u+2*i),1),s[f]=0;return a.map(function(e){var t=s.reduce(function(e,t,n){return e=t<s[e]?n:e},0);e.top=s[t],e.left=c[t],s[t]=s[t]+e.height+2*i;var n=s.reduce(function(e,t,n){return e=t>s[e]?n:e},0);return e.containerHeight=s[n],e})}e=e&&e.hasOwnProperty("default")?e.default:e,t=t&&t.hasOwnProperty("default")?t.default:t,n=n&&n.hasOwnProperty("default")?n.default:n;!function(){function e(e){this.value=e}function t(t){function n(o,i){try{var u=t[o](i),a=u.value;a instanceof e?Promise.resolve(a.value).then(function(e){n("next",e)},function(e){n("throw",e)}):r(u.done?"return":"normal",u.value)}catch(e){r("throw",e)}}function r(e,t){switch(e){case"return":o.resolve({value:t,done:!0});break;case"throw":o.reject(t);break;default:o.resolve({value:t,done:!1})}(o=o.next)?n(o.key,o.arg):i=null}var o,i;this._invoke=function(e,t){return new Promise(function(r,u){var a={key:e,arg:t,resolve:r,reject:u,next:null};i?i=i.next=a:(o=i=a,n(e,t))})},"function"!=typeof t.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)}}();var a=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},f=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},p=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},h=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},d={cursor:"pointer"},v=function(t){var n=t.index,r=t.onClick,o=t.photo,i=t.margin,u=t.direction,a=t.top,c=t.left,s={margin:i};"column"===u&&(s.position="absolute",s.left=c,s.top=a);return e.createElement("img",l({style:r?l({},s,d):s},o,{onClick:r?function(e){r(e,{photo:o,index:n})}:null}))},y=(t.shape({src:t.string.isRequired,width:t.number.isRequired,height:t.number.isRequired,alt:t.string,title:t.string,srcSet:t.oneOfType([t.string,t.array]),sizes:t.oneOfType([t.string,t.array])}),function(t){function r(){var e,t,n,o;a(this,r);for(var i=arguments.length,u=Array(i),c=0;c<i;c++)u[c]=arguments[c];return t=n=p(this,(e=r.__proto__||Object.getPrototypeOf(r)).call.apply(e,[this].concat(u))),n.state={containerWidth:0},n.handleClick=function(e,t){var r=t.index,o=n.props,i=o.photos;(0,o.onClick)(e,{index:r,photo:i[r],previous:i[r-1]||null,next:i[r+1]||null})},o=t,p(n,o)}return s(r,t),c(r,[{key:"componentDidMount",value:function(){var e=this;this.observer=new n(function(t){var n=t[0].contentRect.width;e.state.containerWidth!==n&&e.setState({containerWidth:Math.floor(n)})}),this.observer.observe(this._gallery)}},{key:"componentWillUnmount",value:function(){this.observer.disconnect()}},{key:"render",value:function(){var t=this,n=this.state.containerWidth;if(!n)return e.createElement("div",{ref:function(e){return t._gallery=e}});var r=this.props.ImageComponent,o=void 0===r?v:r,a=this.props,c=a.margin,l=a.onClick,s=a.direction,p=this.props.columns;void 0===p&&(p=1,n>=500&&(p=2),n>=900&&(p=3),n>=1500&&(p=4));var h=this.props.photos,d=n-1,y=void 0,m=void 0;return"row"===s&&(y={display:"flex",flexWrap:"wrap",flexDirection:"row"},m=i({width:d,columns:p,margin:c,photos:h})),"column"===s&&(y={position:"relative"},m=u({width:d,columns:p,margin:c,photos:h}),y.height=m[m.length-1].containerHeight),e.createElement("div",{className:"react-photo-gallery--gallery"},e.createElement("div",{ref:function(e){return t._gallery=e},style:y},m.map(function(n,r){var i=n.left,u=n.top,a=(n.containerHeight,f(n,["left","top","containerHeight"]));return e.createElement(o,{key:n.key||n.src,margin:c,index:r,photo:a,direction:s,left:i,top:u,onClick:l?t.handleClick:null})})))}}]),r}(e.Component));return y.defaultProps={margin:2,direction:"row"},y});
